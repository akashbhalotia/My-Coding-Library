Hard: https://codeforces.com/contest/582/problem/B
